---
import { getLangFromUrl, useTranslations } from "src/i18n/utils";
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---
<section
  class="flex flex-col md:flex-row justify-center items-center md:space-x-[5%] space-y-12 md:space-y-0 py-20 max-w-[100%] w-[80%] mx-auto"
>
  <!-- Retratos -->
  <div class="flex flex-col items-center w-full md:w-1/3">
    <div class="relative w-full max-w-[400px] h-[400px] overflow-hidden">
      <div id="retrato-slider" class="w-full h-full relative">
        <img
          src="/img/8.webp"
          alt="Retrato"
          class="absolute inset-0 w-full h-full object-cover opacity-100 transition-opacity duration-1000"
        />
        <img
          src="/img/9.webp"
          alt="Retrato"
          class="absolute inset-0 w-full h-full object-cover opacity-0 transition-opacity duration-1000"
        />
      </div>
    </div>
    <h3 class="text-center mt-8 md:mt-12 text-2xl md:text-3xl font-light tracking-wide">
      {t("home.servicio1")}
    </h3>
  </div>
  
  <!-- Bodas -->
  <div class="flex flex-col items-center w-full md:w-1/3">
    <span class="block w-full max-w-[400px] md:max-w-[800px]">
      <img
        src="/img/4.webp"
        alt="Bodas"
        class="w-full h-auto"
        decoding="async"
        sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) 800px, 100vw"
        srcset="/img/4.webp 800w, /img/4-480x720.webp 480w"
      />
    </span>
    <h3 class="text-center mt-8 md:mt-12 text-2xl md:text-3xl font-light tracking-wide">
      {t("home.servicio2")}
    </h3>
  </div>
  
  <!-- Parejas -->
  <div class="flex flex-col w-full md:w-1/3 relative items-center md:items-start">
    <div class="w-full max-w-[250px] md:mb-[40%] h-0 md:h-auto overflow-hidden invisible md:visible">
      <img
        src="/img/5.webp"
        alt="Imagen base"
        class="w-full h-full object-cover"
      />
    </div>
    <div
      id="parejas-slider"
      class="relative w-full max-w-[400px] h-[400px] md:h-[370px] md:w-[280px] md:absolute md:bottom-[12%] md:-right-2 overflow-hidden"
    >
      <img
        src="/img/6.webp"
        alt="Parejas"
        class="absolute inset-0 w-full h-full object-cover opacity-100 transition-opacity duration-1000"
      />
      <img
        src="/img/7.webp"
        alt="Parejas"
        class="absolute inset-0 w-full h-full object-cover opacity-0 transition-opacity duration-1000"
      />
    </div>
    <h3 class="text-center mt-8 md:mt-12 text-2xl md:text-3xl font-light tracking-wide">
      {t("home.servicio3")}
    </h3>
  </div>
</section>

<script>
  const retratoSlides: NodeListOf<HTMLImageElement> = document.querySelectorAll(
    "#retrato-slider img",
  );
  const parejasSlides: NodeListOf<HTMLImageElement> = document.querySelectorAll(
    "#parejas-slider img",
  );
  let retratoIndex: number = 0;
  let parejasIndex: number = 0;

  function showSlide(
    slides: NodeListOf<HTMLImageElement>,
    index: number,
  ): void {
    slides.forEach((slide, i) => {
      slide.style.opacity = i === index ? "1" : "0";
    });
  }

  setInterval(() => {
    retratoIndex = (retratoIndex + 1) % retratoSlides.length;
    showSlide(retratoSlides, retratoIndex);
  }, 4000); // Cada 4 segundos

  setInterval(() => {
    parejasIndex = (parejasIndex + 1) % parejasSlides.length;
    showSlide(parejasSlides, parejasIndex);
  }, 5000); // Cada 5 segundos
</script>