---
import { getLangFromUrl, useTranslations } from 'src/i18n/utils';

const lang = getLangFromUrl(Astro.url) as 'es' | 'en';
const t = useTranslations(lang);

const slides = [
  {
    title: t('photoshoots.personal.mini.title'),
    description: t('photoshoots.personal.mini.description'),
    details: JSON.parse(t('photoshoots.personal.mini.details')),
    price: t('photoshoots.personal.mini.price'),
  },
  {
    title: t('photoshoots.personal.reportaje.title'),
    description: t('photoshoots.personal.reportaje.description'),
    details: JSON.parse(t('photoshoots.personal.reportaje.details')),
    price: t('photoshoots.personal.reportaje.price'),
  },
  {
    title: t('photoshoots.personal.experiencia.title'),
    description: t('photoshoots.personal.experiencia.description'),
    details: JSON.parse(t('photoshoots.personal.experiencia.details')),
    price: t('photoshoots.personal.experiencia.price'),
  },
];
---

<section class='bg-white py-16'>
  <div class='max-w-7xl mx-auto'>
    <section class='grid grid-cols-1 md:grid-cols-2 gap-10 p-8'>

      <div class='flex flex-col justify-center text-sm'>
        <h2 class='uppercase'>{t('photoshoots.personal.h2')}</h2>
        <div class='relative w-full max-w-3xl h-auto'>
          <!-- Slides -->
          <div
            class='slider'
            id='slider-personal'
            data-slides={JSON.stringify(slides)}
          ></div>

          <a href='#contactForm' class='link-button mt-8'>
            {t('photoshoots.personal.button')}
          </a>

          <!-- Navigation Arrows -->
          <button class='absolute top-1/2 left-2 transform -translate-y-1/2' id='prevPersonal' aria-label='Anterior'>
            <svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='#222' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path stroke='none' d='M0 0h24v24H0z' fill='none'/><path d='M15 6l-6 6l6 6'/></svg>
          </button>
          <button class='absolute top-1/2 right-2 transform -translate-y-1/2' id='nextPersonal' aria-label='Siguiente'>
            <svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='#222' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path stroke='none' d='M0 0h24v24H0z' fill='none'/><path d='M9 6l6 6l-6 6'/></svg>
          </button>
        </div>
      </div>

      <div class='flex justify-center items-start'>
        <img src='/img/35.webp' alt='Ariadna' class='w-auto h-[70vh]'>
      </div>

    </section>
  </div>
</section>

<style>
  .slider {
    position: relative;
    width: 100%;
    height: auto;
    overflow: hidden;
  }
  .slider .fade {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    opacity: 0;
    transition: opacity 0.5s ease-in-out;
    display: none;
  }
  .slider .active {
    opacity: 1;
    display: block;
  }
</style>

<script type='module'>
  const sliderPersonal = document.getElementById('slider-personal');
  const raw = sliderPersonal?.dataset.slides || '[]';
  const slides = JSON.parse(raw);

  slides.forEach(slide => {
    const slideDiv = document.createElement('div');
    slideDiv.classList.add('fade', 'flex', 'flex-col', 'justify-center', 'text-gray-800', 'p-4');

    slideDiv.innerHTML = `
      <h3 class='text-5xl'>${slide.title}</h3>
      <p class='mt-4'>${slide.description}</p>
      <ul class='mt-4'>
        ${slide.details.map(detail => `<li>â€¢ ${detail}</li>`).join('')}
      </ul>
      <hr class='my-4 bg-slate-900'>
      <p class='font-claster text-4xl'>${slide.price}</p>
    `;
    sliderPersonal.appendChild(slideDiv);
  });

  let currentSlide = 0;
  const slidesElements = sliderPersonal.querySelectorAll('.fade');
  slidesElements.forEach((slide, index) => {
    if (index === 0) {
      slide.classList.add('active');
      slide.style.display = 'block';
    } else {
      slide.classList.remove('active');
      slide.style.display = 'none';
    }
  });

  function showSlide(index) {
    const nodes = sliderPersonal.querySelectorAll('.fade');
    nodes[currentSlide].classList.remove('active');
    nodes[currentSlide].style.display = 'none';
    currentSlide = (index + nodes.length) % nodes.length;
    nodes[currentSlide].classList.add('active');
    nodes[currentSlide].style.display = 'block';
  }

  document.getElementById('prevPersonal')?.addEventListener('click', () => showSlide(currentSlide - 1));
  document.getElementById('nextPersonal')?.addEventListener('click', () => showSlide(currentSlide + 1));
</script>
